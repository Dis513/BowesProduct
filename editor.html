<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Vector Editor Pro ‚Äì BowesProduct (Illustrator-style)</title>
  <style>
  *, *::before, *::after { box-sizing: border-box; }
  html, body { margin: 0; height: 100%; background: #020617; color: white; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; overflow: hidden; -webkit-font-smoothing: antialiased; }
  
  /* ================= HEADER WITH MENU BAR ================= */
  .site-header {
    position: sticky; top: 0; z-index: 1000; background: rgba(2,6,23,0.95); border-bottom: 1px solid #1e293b; backdrop-filter: blur(10px);
  }
  .header-inner { max-width: 1200px; margin: 0 auto; padding: 0.6rem 1rem; display: flex; align-items: center; justify-content: space-between; }
  .header-left { display: flex; align-items: center; gap: 1.6rem; }
  .logo a { font-size: 1.3rem; font-weight: 700; color: white; text-decoration: none; white-space: nowrap; }
  .main-nav { display: flex; gap: 1.4rem; }
  .main-nav a { color: #e5e7eb; text-decoration: none; font-size: 0.95rem; }
  .main-nav a:hover, .main-nav a.active { color: #60a5fa; }
  .menu-bar {
    display: flex; gap: 1.5rem; font-size: 0.9rem; margin-left: 2rem;
  }
  .menu-bar > div {
    position: relative; cursor: pointer;
  }
  .menu-bar > div:hover { color: #60a5fa; }
  .dropdown {
    position: absolute; top: 100%; left: 0; background: #0f172a; border: 1px solid #1e293b; min-width: 180px; display: none; flex-direction: column; box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  }
  .dropdown a, .dropdown div {
    padding: 0.6rem 1rem; text-align: left; white-space: nowrap;
  }
  .dropdown a:hover, .dropdown div:hover { background: #1e293b; }
  .menu-bar > div:hover .dropdown { display: flex; }

  .header-right { display: flex; align-items: center; gap: 0.8rem; min-height: 44px; }
  #profilePic { width: 32px; height: 32px; border-radius: 50%; border: 2px solid #60a5fa; object-fit: cover; display: none; }
  .login-btn { padding: 0.45rem 1.1rem; border-radius: 999px; border: 1.5px solid #60a5fa; background: transparent; color: #60a5fa; font-size: 0.95rem; cursor: pointer; }

  /* ================= MAIN LAYOUT ================= */
  #container { position: relative; width: 100%; height: 100%; padding-top: 70px; padding-bottom: 80px; }
  #canvas { display: block; width: 100%; height: 100%; background: #0a0a0a; touch-action: none; outline: none; }

  /* ================= LEFT TOOLBAR (Illustrator Advanced) ================= */
  #floatingToolbar {
    position: fixed; left: 20px; top: 90px; background: rgba(30, 41, 59, 0.95); padding: 12px; border-radius: 12px; border: 1px solid #1e293b; backdrop-filter: blur(8px); z-index: 1150;
  }
  .tool-group { display: flex; flex-direction: column; gap: 4px; margin-bottom: 8px; }
  .tool-group:last-child { margin-bottom: 0; }
  .tool-btn {
    width: 44px; height: 44px; border-radius: 8px; border: 1px solid #475569; background: rgba(2, 6, 23, 0.8); color: #94a3b8; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; font-size: 1.4rem;
  }
  .tool-btn:hover { background: rgba(51, 65, 85, 1); color: white; }
  .tool-btn.active { color: #60a5fa; border-color: #60a5fa; background: rgba(2, 6, 23, 1); }

  /* ================= RIGHT PANEL ================= */
  .panel {
    position: absolute; top: 90px; right: 20px; width: 380px; max-height: calc(100vh - 220px); background: rgba(2, 6, 23, 0.95); border: 1px solid #1e293b; border-radius: 12px; padding: 1.5rem; overflow-y: auto; z-index: 20; backdrop-filter: blur(10px); transition: transform 0.3s ease; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  }
  .panel.hidden { transform: translateX(420px); }
  #panelToggle { /* same as before */ }
  .panel h2 { color: #60a5fa; margin: 1.5rem 0 1rem; font-size: 1.1rem; border-bottom: 1px solid #1e293b; padding-bottom: 0.5rem; }
  .control-group { margin-bottom: 1.2rem; }
  label { display: block; font-size: 0.9rem; color: #e5e7eb; margin-bottom: 0.4rem; }
  input, select { width: 100%; padding: 0.5rem; border-radius: 0.375rem; border: 1px solid #1f2937; background: #020617; color: #e5e7eb; }
  input[type="range"] { accent-color: #60a5fa; }
  input[type="color"] { height: 44px; }

  /* Mobile & Footer same */
  @media (max-width: 900px) { /* same as before */ }
  .site-footer { /* same */ }
  #loader { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #60a5fa; font-size: 1.5rem; font-weight: bold; pointer-events: none; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/paper@0.12.17/dist/paper-full.min.js"></script>
  <script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
<header class="site-header">
  <div class="header-inner">
    <div class="header-left">
      <div class="logo"><a href="index.html">BowesProduct</a></div>
      <nav class="main-nav">
        <a href="index.html">Home</a>
        <a href="models.html">Models</a>
        <a href="retexture.html">Retexture</a>
        <a href="editor.html" class="active">Editor</a>
      </nav>
      <div class="menu-bar">
        <div>File
          <div class="dropdown">
            <div onclick="newDocument()">New</div>
            <div>Open...</div>
            <div>Save</div>
            <div>Export > SVG</div>
            <div>Export > PNG</div>
          </div>
        </div>
        <div>Edit
          <div class="dropdown">
            <div>Undo</div>
            <div>Redo</div>
            <div>Cut</div>
            <div>Copy</div>
            <div>Paste</div>
          </div>
        </div>
        <div>Object
          <div class="dropdown">
            <div>Group</div>
            <div>Ungroup</div>
            <div>Transform</div>
          </div>
        </div>
        <div>Type
          <div class="dropdown">
            <div>Create Outlines</div>
            <div>Font...</div>
          </div>
        </div>
        <div>Select
          <div class="dropdown">
            <div>All</div>
            <div>Deselect</div>
          </div>
        </div>
        <div>View
          <div class="dropdown">
            <div>Zoom In</div>
            <div>Zoom Out</div>
            <div>Fit Artboard</div>
          </div>
        </div>
        <div>Window
          <div class="dropdown">
            <div>Layers</div>
            <div>Properties</div>
            <div>Swatches</div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-right">
      <img id="profilePic" alt="Profile">
      <button id="authBtn" class="login-btn">Login</button>
    </div>
  </div>
</header>

<div id="container">
  <div id="loader">Vector Editor ‚Ä¢ Use tools to draw</div>
  <canvas id="canvas" resize></canvas>

  <!-- Expanded Illustrator Toolbar -->
  <div id="floatingToolbar">
    <div class="tool-group">
      <div class="tool-btn active" id="selectTool" title="Selection (V)">‚¨ö</div>
      <div class="tool-btn" id="directSelectTool" title="Direct Selection (A)">‚Üñ</div>
    </div>
    <div class="tool-group">
      <div class="tool-btn" id="penTool" title="Pen (P)">‚úí</div>
      <div class="tool-btn" id="pencilTool" title="Pencil (N)">‚úè</div>
      <div class="tool-btn" id="brushTool" title="Brush (B)">üñå</div>
    </div>
    <div class="tool-group">
      <div class="tool-btn" id="rectangleTool" title="Rectangle (M)">‚ñ°</div>
      <div class="tool-btn" id="ellipseTool" title="Ellipse (L)">‚óã</div>
      <div class="tool-btn" id="polygonTool" title="Polygon">üî∫</div>
      <div class="tool-btn" id="lineTool" title="Line">‚ï±</div>
    </div>
    <div class="tool-group">
      <div class="tool-btn" id="typeTool" title="Type (T)">T</div>
      <div class="tool-btn" id="eyedropperTool" title="Eyedropper (I)">üíß</div>
      <div class="tool-btn" id="eraseTool" title="Eraser">‚úÇ</div>
    </div>
    <div class="tool-group">
      <div class="tool-btn" id="handTool" title="Hand (H)">‚úã</div>
      <div class="tool-btn" id="zoomTool" title="Zoom (Z)">üîç</div>
    </div>
  </div>

  <!-- Right Panel -->
  <div class="panel visible" id="panel">
    <button id="panelToggle">‚Üê</button>
    <h2>Properties</h2>
    <div id="propertiesContent">Select an object</div>

    <h2>Layers</h2>
    <ol id="layersList"></ol>
    <button id="addLayerBtn">+ Add Layer</button>

    <h2>Appearance</h2>
    <div class="control-group">
      <label>Fill</label>
      <input type="color" id="fillColor" value="#ff0000">
    </div>
    <div class="control-group">
      <label>Stroke</label>
      <input type="color" id="strokeColor" value="#000000">
    </div>
    <div class="control-group">
      <label>Stroke Width</label>
      <input type="range" min="0" max="50" value="1" id="strokeWidth">
      <span id="strokeWidthVal">1</span>
    </div>

    <h2>Export</h2>
    <button id="exportSVG">Export SVG</button>
    <button id="exportPNG">Export PNG</button>
  </div>
</div>

<footer class="site-footer"> ... </footer>
<div id="mobilePanelToggle"><span>‚ñ≤ Controls</span></div>

<!-- Firebase same as before -->

<script type="text/paperscript" canvas="canvas">
var currentPath;
var fillColor = new Color('#ff0000');
var strokeColor = new Color('#000000');
var strokeWidth = 1;

var selectTool = new Tool();
var penTool = new Tool();
var rectangleTool = new Tool();
var typeTool = new Tool();
var eyedropperTool = new Tool();

// Selection
selectTool.onMouseDrag = function(event) {
  if (project.selectedItems.length > 0) {
    project.selectedItems.forEach(item => item.position += event.delta);
  }
};

// Pen Tool
penTool.onMouseDown = function(event) {
  currentPath = new Path({
    strokeColor: strokeColor,
    strokeWidth: strokeWidth
  });
  currentPath.add(event.point);
};
penTool.onMouseDrag = function(event) {
  currentPath.add(event.point);
};
penTool.onMouseUp = function() {
  currentPath.simplify();
  currentPath.selected = true;
};

// Rectangle
rectangleTool.onMouseDrag = function(event) {
  if (currentPath) currentPath.remove();
  var rect = new Rectangle(event.downPoint, event.point);
  currentPath = new Path.Rectangle(rect);
  currentPath.fillColor = fillColor;
  currentPath.strokeColor = strokeColor;
  currentPath.strokeWidth = strokeWidth;
};
rectangleTool.onMouseUp = function() {
  currentPath.selected = true;
};

// Type
typeTool.onMouseDown = function(event) {
  var text = new PointText(event.point);
  text.content = 'Edit text';
  text.fillColor = fillColor;
  text.fontSize = 32;
  text.justification = 'center';
  text.selected = true;
};

// Eyedropper
eyedropperTool.onMouseDown = function(event) {
  var hit = project.hitTest(event.point);
  if (hit && hit.item) {
    if (hit.type === 'fill' && hit.item.fillColor) {
      document.getElementById('fillColor').value = hit.item.fillColor.toCSS(true);
      fillColor = hit.item.fillColor;
    }
    if (hit.type === 'stroke' && hit.item.strokeColor) {
      document.getElementById('strokeColor').value = hit.item.strokeColor.toCSS(true);
      strokeColor = hit.item.strokeColor;
    }
  }
};

// Activate tools
document.getElementById('selectTool').onclick = () => selectTool.activate();
document.getElementById('penTool').onclick = () => penTool.activate();
document.getElementById('rectangleTool').onclick = () => rectangleTool.activate();
document.getElementById('typeTool').onclick = () => typeTool.activate();
document.getElementById('eyedropperTool').onclick = () => eyedropperTool.activate();

// Color & Stroke sync
document.getElementById('fillColor').oninput = e => {
  fillColor = e.target.value;
  if (project.selectedItems.length) project.selectedItems.forEach(i => i.fillColor = fillColor);
};
document.getElementById('strokeColor').oninput = e => {
  strokeColor = e.target.value;
  if (project.selectedItems.length) project.selectedItems.forEach(i => i.strokeColor = strokeColor);
};
document.getElementById('strokeWidth').oninput = e => {
  strokeWidth = parseFloat(e.target.value);
  document.getElementById('strokeWidthVal').textContent = strokeWidth;
  if (project.selectedItems.length) project.selectedItems.forEach(i => i.strokeWidth = strokeWidth);
};

// Properties update
project.on('selectionchanged', () => {
  var item = project.selectedItems[0];
  var html = item ? `<p>Type: ${item.className}</p><p>Position: ${item.position}</p>` : 'No selection';
  document.getElementById('propertiesContent').innerHTML = html;
});

// Export
function exportSVG() {
  var svg = project.exportSVG({asString: true});
  var blob = new Blob([svg], {type: 'image/svg+xml'});
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a');
  a.href = url; a.download = 'artwork.svg'; a.click();
}
function exportPNG() {
  var data = view.element.toDataURL('image/png');
  var a = document.createElement('a');
  a.href = data; a.download = 'artwork.png'; a.click();
}
</script>

<script>
// Panel toggle, menu actions, etc.
function newDocument() { project.clear(); }
document.querySelectorAll('.dropdown div').forEach(item => {
  item.onclick = () => {
    if (item.textContent.includes('Export > SVG')) exportSVG();
    if (item.textContent.includes('Export > PNG')) exportPNG();
  };
});
// Panel toggle same as previous
document.getElementById('loader').style.display = 'none';
</script>
</body>
</html>
